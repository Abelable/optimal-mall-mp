<wxs module="TIME" src="/utils/filters/time.wxs" />
<wxs module="NUM" src="/utils/filters/num.wxs" />

<view class="note-item" bindtap="navToNoteDetail">
  <view class="author-info-wrap row" catchtap="navToAuthorCenter">
    <image class="author-avatar avatar-default" src="{{item.authorInfo.avatar}}" lazy-load />
    <view class="name-wrap">
      <view class="author-name">{{item.authorInfo.nickname}}</view>
      <view class="row">
        <view class="time">{{TIME.timeDiff(item.createdAt)}}</view>
        <view class="address row" wx:if="{{item.address}}">
          <text class="split-spot">·</text>
          <image class="address-icon" src="/images/media-item/address.png" />
          <text class="address-detail omit single-line">{{item.address}}</text>
        </view>
      </view>
    </view>
  </view>

  <image-grid list="{{item.imageList}}" />
  
  <view class="title">{{item.title}}</view>
  <view class="content omit" wx:if="{{item.content}}">{{item.content}}</view>

  <view class="commodity-list" wx:if="{{item.commodityList.length}}">
    <view 
      class="commodity-item row" 
      wx:for="{{item.commodityList}}" 
      wx:key="_index" 
      wx:for-index="_index" 
      wx:for-item="_item" 
      catchtap="checkCommodityDetail" 
      data-type="{{_item.type}}" 
      data-id="{{_item.id}}"
    >
      <view class="commodity-image-wrap">
        <image class="commodity-image" src="{{_item.cover}}" />
        <view class="type-tag row">{{['景点', '酒店',  '餐馆', '商品'][item.type - 1]}}</view>
      </view>
      <view class="commodity-info">
        <view class="commodity-name omit single-line">{{_item.name}}</view>
        <view class="row between baseline">
          <view class="row baseline">
            <price-unit price="{{_item.price || 0}}" unit="{{_item.type !== 4 ? '起' : ''}}" fontSize="22rpx" integerFontSize="26rpx" />
            <view class="market-price" wx:if="{{_item.marketPrice}}}">¥{{_item.marketPrice}}</view>
          </view>
          <view class="sales-volumns" wx:if="{{_item.marketPrice}}}">已售{{_item.marketPrice}}}件</view>
        </view>
      </view>
    </view>
  </view>
  
  <view class="btn-wrap">
    <view class="btn-item">
      <image class="btn-icon" src="/images/media-item/comment.png" />
      <view class="btn-data">{{NUM.over(item.commentsNumber, 100000)}}</view>
    </view>
    <view class="other-btns">
      <view class="btn-item" style="margin-right: 68rpx;" catchtap="like">
        <image class="btn-icon" src="/images/media-item/heart{{item.isLike ? '-active' : ''}}.png" />
        <view class="btn-data">{{NUM.over(item.likeNumber, 100000)}}</view>
      </view>
      <view class="btn-item" catchtap="collect">
        <image class="btn-icon" src="/images/media-item/collection{{item.isCollected ? '-active' : ''}}.png" />
        <view class="btn-data">{{NUM.over(item.collectionTimes, 100000)}}</view>
      </view>
    </view>
  </view>
</view>
